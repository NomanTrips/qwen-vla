# Training run with fixed key press data
# Now includes W key presses from textInput events

model:
  qwen_vl:
    model_name: "Qwen/Qwen3-VL-2B-Instruct"
    load_in_4bit: true
    target_layer: 14
  temporal:
    num_frames: 3
    add_temporal_embeddings: true
  projectors:
    action_dim: 13  # 4 mouse + 3 buttons + 6 keys
    expert_hidden_dim: 512
  expert:
    action_dim: 13
    hidden_dim: 512
    num_layers: 6
    num_heads: 8
  chunk_size: 50

training:
  batch_size: 2
  num_epochs: 50
  max_steps: 0
  grad_accumulation: 1
  learning_rate: 1.0e-4
  weight_decay: 0.01
  warmup_steps: 50
  max_grad_norm: 1.0
  log_every: 5
  save_every: 200
  output_dir: "checkpoints/fixed_data_run"
  mixed_precision: "bf16"

  use_wandb: true
  use_tensorboard: false
  wandb_project: "qwen-vla"
  wandb_run_name: "fixed-keypress-data-50ep"

  num_workers: 2

dataset:
  module: "data.dataset"
  class_name: "MiniworldVLADataset"
  kwargs:
    episode_dirs: "data/processed/ep_0001"
    num_frames: 3
    frame_skip: 2
    chunk_size: 50
    instruction: "Navigate to find the sign showing a color, then touch the object matching that color."
  collate_module: "data.dataset"
  collate_fn: "collate_vla_batch"
